---
layout: post
status: publish
published: true
title: Look, no Arduino - XBee ZB Series 2.x Digital Input
author:
  display_name: martin
  login: martin
  email: martin@freakent.co.uk
  url: http://www.freakent.co.uk
author_login: martin
author_email: martin@freakent.co.uk
author_url: http://www.freakent.co.uk
wordpress_id: 602
wordpress_url: http://www.freakent.co.uk/?p=602
date: '2013-01-20 23:49:54 +0000'
date_gmt: '2013-01-20 23:49:54 +0000'
categories:
- Internet of Things
tags:
- Arduino
- xbee
- zigbee
- digital io
comments:
- id: 493
  author: N8
  author_email: n8@radi.cl
  author_url: ''
  date: '2013-04-21 23:36:49 +0100'
  date_gmt: '2013-04-21 23:36:49 +0100'
  content: Is the LED to provide a ~2.0V voltage drop so the voltage that arrives
    at the DI is ~3.0V instead of 5V? Or was that just just an unintended outcome?
- id: 495
  author: martin
  author_email: martin@freakent.co.uk
  author_url: http://www.freakent.co.uk
  date: '2013-04-22 17:19:16 +0100'
  date_gmt: '2013-04-22 17:19:16 +0100'
  content: I hadn't considered the drop from from 5V to 3V, it was just there to give
    a visual indication that something was happening.
- id: 496
  author: N8
  author_email: n8@radi.cl
  author_url: ''
  date: '2013-04-22 17:46:31 +0100'
  date_gmt: '2013-04-22 17:46:31 +0100'
  content: "Ha, I guess just dumb luck then. It' not clear if you had skipped the
    LED and you pumped 5V into XBee DI pins expecting 3.3V if you would have done
    some damage.\r\n\r\nBTW: Much thanks for writing this up, the information about
    the API frame gave me a big head start on a remote control project that I am working
    on."
- id: 497
  author: N8
  author_email: n8@radi.cl
  author_url: ''
  date: '2013-04-22 18:04:19 +0100'
  date_gmt: '2013-04-22 18:04:19 +0100'
  content: 'According to DigiKey, you should not apply more than 3.3V to any input
    : http://www.digi.com/support/kbase/kbaseresultdetl?id=2160 , so yeah dumb luck
    ;-)'
- id: 512
  author: developpef
  author_email: no@no.fr
  author_url: http://developpef.blogspot.fr
  date: '2013-05-17 14:44:35 +0100'
  date_gmt: '2013-05-17 14:44:35 +0100'
  content: Awesome!! You just saved my weekend!! Since more than 2 days I was looking
    for a simple explanation of standalone Xbee confiduration... Nowhere it is indicated
    that with Coordinator and Router, router DH+DL can only be set to 0... You are
    my god :)
- id: 516
  author: avinash
  author_email: avideep90@gmail.com
  author_url: ''
  date: '2013-05-26 17:21:14 +0100'
  date_gmt: '2013-05-26 17:21:14 +0100'
  content: my thing is not working. Please help me out. I have exactly the same XBee
    module (S2). Does ATMY id matter? What could possibly going wrong with me? Can
    u please tell me in detail about the configuration of the coordinator.
- id: 517
  author: martin
  author_email: martin@freakent.co.uk
  author_url: http://www.freakent.co.uk
  date: '2013-05-27 09:10:10 +0100'
  date_gmt: '2013-05-27 09:10:10 +0100'
  content: As I said in my blog, the only parameter I had to change on the coordinator
    was the PAN ID. I recommend re-flashing the firmware to the latest, which should
    also reset everything to defaults, and then just setting the PAN ID.
- id: 526
  author: martin
  author_email: martin@freakent.co.uk
  author_url: http://www.freakent.co.uk
  date: '2013-06-01 07:05:57 +0100'
  date_gmt: '2013-06-01 07:05:57 +0100'
  content: N8, you are absolutely right. I was using a variable power supply and it
    turns out I had it set at 3.3V instead of 5V, hence no damage. I will update the
    diagrams to use of the regulated 3.3V output into the switch.
- id: 529
  author: martin
  author_email: martin@freakent.co.uk
  author_url: http://www.freakent.co.uk
  date: '2013-06-04 14:14:18 +0100'
  date_gmt: '2013-06-04 14:14:18 +0100'
  content: N8, I have updated my post to correctly show no more than 3.3V being applied
    to D0. Many thanks for the feedback!
- id: 561
  author: eyad
  author_email: eyad_soliman@yahoo.com
  author_url: ''
  date: '2013-06-20 09:25:34 +0100'
  date_gmt: '2013-06-20 09:25:34 +0100'
  content: in your project you transferred the digital input pin status of the router
    to the coordinator then read it through x-ctu , my question is can you directly
    transfer the digital input on the router digital input pin directly to a digital
    output pin of the coordinator ?
- id: 562
  author: martin
  author_email: martin@freakent.co.uk
  author_url: http://www.freakent.co.uk
  date: '2013-06-20 10:47:36 +0100'
  date_gmt: '2013-06-20 10:47:36 +0100'
  content: I don't believe so, not without a micro-controller or another computer
    connected to the coordinator to parse the message from the router. Maybe that
    Series 1 XBee have this feature.
- id: 616
  author: Johann Uys
  author_email: juys@cscape.co.za
  author_url: ''
  date: '2013-08-18 10:18:25 +0100'
  date_gmt: '2013-08-18 10:18:25 +0100'
  content: |-
    Hi

    I have tried everything you said must be done but there is no ways I can get a Xbee to talk from input an A to output on B.
    I can get two computers to talk to one another with the very same Xbee's.
    Please help my I have tried everything.
    What am I doing wrong.

    Regards

    Johann
- id: 617
  author: martin
  author_email: martin@freakent.co.uk
  author_url: http://www.freakent.co.uk
  date: '2013-08-18 21:08:16 +0100'
  date_gmt: '2013-08-18 21:08:16 +0100'
  content: Johann, that's not how I am using the S2 XBee's. The receiving XBee (the
    coordinator) is being accessed through external software via the API. I think
    the S1 XBee's might support what you are expecting. If you monitor the receiver
    using the X-CTU software you should see data messages being received.
- id: 618
  author: Johann Uys
  author_email: juys@cscape.co.za
  author_url: ''
  date: '2013-08-19 09:14:21 +0100'
  date_gmt: '2013-08-19 09:14:21 +0100'
  content: Martin, Please be so kind as to post me your complete and total setup for
    S2 Xbee as I also have some of them. If possible line for linefor X-CTU. I have
    been battling for the past week with this. I also find that for some obscure reason
    I can not talk to some of the units after a while. I am even trying to reset these
    units manually ie. Reset (Pin5) to Gnd. I am beginning to think that Xbee is not
    very reliable. I have used the above units in projects for some time. If you can
    help I will be very thankful. Johann
- id: 619
  author: Johann Uys
  author_email: juys@cscape.co.za
  author_url: ''
  date: '2013-08-19 09:26:06 +0100'
  date_gmt: '2013-08-19 09:26:06 +0100'
  content: Martin, Another problem, why when I do a Test Query I only get an answer
    on the second try and NOT on the first attempt. Johann
- id: 620
  author: martin
  author_email: martin@freakent.co.uk
  author_url: http://www.freakent.co.uk
  date: '2013-08-19 10:09:02 +0100'
  date_gmt: '2013-08-19 10:09:02 +0100'
  content: 'Which firmware are you using? Sounds like the XBee may be entering sleep
    mode. I have found my XBee''s to be 100% reliable for many months. '
- id: 621
  author: martin
  author_email: martin@freakent.co.uk
  author_url: http://www.freakent.co.uk
  date: '2013-08-19 10:12:14 +0100'
  date_gmt: '2013-08-19 10:12:14 +0100'
  content: 'Everything I did is detailed in this blog post. Nothing else I can add. '
- id: 1106
  author: Jee Won Kim
  author_email: jeewonkim0110@gmail.com
  author_url: ''
  date: '2013-11-26 07:57:33 +0000'
  date_gmt: '2013-11-26 07:57:33 +0000'
  content: "Hello, thanks for post.\r\nXbee Series 1 radio can do direct Input/Output
    function without microcontroller?\r\nIf yes, only digital for now? I heard that
    the latest firmware can now support analog output for Xbees but I am not sure
    if that refers to only Xbee Series 2 (Zigbee)"
- id: 1123
  author: martin
  author_email: martin@freakent.co.uk
  author_url: http://www.freakent.co.uk
  date: '2013-11-26 13:14:22 +0000'
  date_gmt: '2013-11-26 13:14:22 +0000'
  content: I don't have series 1 XBee so I can not say.
- id: 8064
  author: phyllicia
  author_email: phy11icia@yahoo.ca
  author_url: ''
  date: '2014-06-17 03:14:45 +0100'
  date_gmt: '2014-06-17 03:14:45 +0100'
  content: "Hi,\r\nI would like to ask how you qualify the test of the XBee Sensor
    and the accuracy?\r\nAny Certificate of Conformance for these sensors?"
- id: 8077
  author: martin
  author_email: martin@freakent.co.uk
  author_url: http://www.freakent.co.uk
  date: '2014-06-17 12:19:37 +0100'
  date_gmt: '2014-06-17 12:19:37 +0100'
  content: In my set up the XBee isn't the sensor, it's the communications mechanism.
    The accuracy of any sensor you connect to the XBee would have to be separately
    verified as suitable for the application for which it is being used.
- id: 8130
  author: Camilo
  author_email: camds_19@yahoo.es
  author_url: ''
  date: '2014-06-20 03:04:45 +0100'
  date_gmt: '2014-06-20 03:04:45 +0100'
  content: "hello \r\nI was looking for an example like this to xbee s2, but only
    found for s1, thanks. \r\nCan you do the same for an analog signal (without microcontroller)?
    Is enough to set analog input to enable DIO ? or should I make other changes?
    Is it true, that the analog input must not exceed 1.2V? Thank you."
- id: 17437
  author: Sam
  author_email: sagarjariwala08@gmail.com
  author_url: ''
  date: '2015-02-10 14:50:29 +0000'
  date_gmt: '2015-02-10 14:50:29 +0000'
  content: "Hello martin I want to transmit 4 bit [D0-D3 of xbee s2(pin 17-20)] data
    form coordinator xbee s2 to router xbee s2 (or form router xbee s2 to router xbee
    s2)..\r\nSo plzz help me.\r\nhow to do this configure.\r\ni don't able to buy
    s1 now... so plz reply as soon as possible....."
- id: 17509
  author: martin
  author_email: martin@freakent.co.uk
  author_url: http://www.freakent.co.uk
  date: '2015-02-25 23:49:04 +0000'
  date_gmt: '2015-02-25 23:49:04 +0000'
  content: Sorry, I can't help with that.
- id: 19072
  author: Morgan
  author_email: Morgandechile@gmail.com
  author_url: ''
  date: '2015-06-21 00:53:20 +0100'
  date_gmt: '2015-06-21 00:53:20 +0100'
  content: "Hello Martin \r\nThanks a lot for your examples ... I am actualli having
    trouble to find examples of Only-Xbee (no-arduino) kind of projects ...\r\nthe
    truth is really i have like million questions but i will try to keep it simple
    ....\r\nhave you tried or have some examples with XBee Pro S3B ??\r\nis too different
    drom S2 ???\r\n\r\nother ... have you any example code for the procesor inside
    the xBee Pro S3B ??\r\nanything to turn it on or turn it sleep remotely ?? \r\nthanks
    !!!"
- id: 19074
  author: martin
  author_email: martin@freakent.co.uk
  author_url: http://www.freakent.co.uk
  date: '2015-06-21 04:13:10 +0100'
  date_gmt: '2015-06-21 04:13:10 +0100'
  content: Sorry, no experience with XBee Pro S3B.
- id: 26515
  author: BestFelica
  author_email: mikaylaheiden@freenet.de
  author_url: https://FollowBurton.blogspot.se
  date: '2018-05-09 04:20:10 +0100'
  date_gmt: '2018-05-09 04:20:10 +0100'
  content: "I have noticed you don't monetize your website, don't waste your traffic,\r\nyou
    can earn additional cash every month because you've got high quality \r\ncontent.
    If you want to know how to make extra \r\nmoney, search for: Ercannou's essential
    adsense alternative"
---
<p><a href="http://www.freakent.co.uk/2013/01/20/look-no-arduino-xbee-sensor-network/img_0350/" rel="attachment wp-att-627"><img class=" wp-image-627 alignright" alt="IMG_0350" src="http://www.freakent.co.uk/wp-content/uploads/2013/01/IMG_0350.jpg" width="200" /></a>In preparation for my next project (an XBEE powered rain gauge) I have been investigating how to collect sensor data with just <a href="http://www.freakent.co.uk/2012/01/19/digi-xbee-zb/" target="_blank">Digi XBee modules</a>. So far all my sensor projects have used an Arduino to collect data then use either WiFi or XBee to send the data to my server for processing. It turns out that the XBee modules have 12 digital input/output and 4 analog input pins that can be used directly. For basic sensor projects it should be possible to use an XBee to collect sensor data without the need for an additional micro-controller such as the Arduino.</p>
<p><!--more--></p>
<p>There is plenty of information on the web about using digital IO with Series 1 XBee, but I have the Series 2.x ZB modules. Digital IO works quite differently on Series 2.x than to Series 1, so I thought I'd share how I got a basic setup working.</p>
<p>For this setup I used:</p>
<ul>
<li>Two XBee Series 2.x modules</li>
<li><a href="https://www.sparkfun.com/products/8687" target="_blank">Sparkfun XBee Explorer USB</a></li>
<li><a href="https://www.sparkfun.com/products/11373" target="_blank">Sparkfun Explorer (Regulated)</a></li>
<li><a href="http://www.digi.com/support/productdetail?pid=3352&amp;osvid=57&amp;type=utilities" target="_blank">Digi's X-CTU software</a></li>
<li><a href="http://www.ftdichip.com/Drivers/VCP.htm" target="_blank">FTDI Serial USB driver</a></li>
<li>Breadboard and jumper wires</li>
<li>Push switch, LED and a resistor</li>
</ul>
<p><strong>Setup X-CTU and FTDI drivers</strong><br />
Both XBees are going to need upgrading and extra configuration. For this you need to have Digi's X-CTU software running on a Windows PC. I have the XBee connected to the PC a the Sparkfun Explorer USB.</p>
<p>If you haven't used the Explorer with X-CTU before you will first need to install the FTDI Serial USB driver on your PC. Download and unzip the driver archive from <a href="http://www.ftdichip.com/Drivers/VCP.htm" target="_blank">here</a> to a temporary directory. The drivers don't have an installer. Carefully plug an XBee module into the Explorer USB (make sure you get it the right way round) and plug that into a free USB port on the PC. Windows will probably complain it can't find an appropriate driver. Open Windows' Device Manager and look for a USB device with a yellow exclamation mark. Right click the device and update the driver, choose the directory where you unzipped the archive when prompted for a driver location. I had to repeat this a couple of times to get rid of all the exclamation marks.</p>
<p>Download and install X-CTU from Digi's web site. It does have a regular installer so installation is straightforward. After installation has finished, run X-CTU and you should see the USB port with your XBee Explorer listed. Select that port and click the test button to ensure everything is configured OK.</p>
<p><strong>Upgrade XBee firmware</strong><br />
By default, XBees come with the Router firmware installed. On both my Xbees the firmware version pre-installed was not the latest version so I updated both. One module needs to be configured as a Coordinator. For digital IO to work, <strong>the Coordinator must use the API version of the firmware</strong>. The other module I just upgraded to the latest Router AT firmware.</p>
<p><strong>Configure the Sensor XBee (with Router firmware)</strong><br />
Although you can use the XBee's command mode and AT commands to configure the module, it is much easier to configure the module using X-CTU.</p>
<p><a href="http://www.freakent.co.uk/2013/01/20/look-no-arduino-xbee-sensor-network/x-ctu-config/" rel="attachment wp-att-633"><img class=" wp-image-633 alignright" alt="x-ctu config" src="http://www.freakent.co.uk/wp-content/uploads/2013/01/x-ctu-config.png" width="250" /></a>Set the following XBee module parameters:</p>
<ul>
<li>PAN ID (under Networking)<br />
This identifies the network to use. If you don't set this, the modules are supposed to negotiate a common PAN ID but I haven't had much luck with that. I find it simpler to just choose a number a set all XBees to that number.</li>
<li>DH and DL (under Addressing)<br />
This is the destination address where this module will send all its data. Each module has a unique number which is made up of a high and a low value. As a convinience the Coordinator can also be addressed as 0/0, so make sure both DH and DL is 0 (zero).</li>
<li>D0 (under I/O Settings)<br />
Setting this to 3 enable the D0 input pin for Digital Input.</li>
<li>Digital IO Change Detection (under I/O Settings, I/O Sampling)<br />
Using Change Detection means that the XBee will send a message to the DH+DL (i.e. the Coordinator in our case) whenever the reading at the pin changes. This setting is a bit field, where each bit represents an individual pin, that allows you to enable Change Detection on specific pins. I'm lazy so I just enabled it on all pins by setting it to FFFF :-)</li>
</ul>
<p><strong>Configure the Server XBee (with Coordinator firmware)<br />
</strong>The only configuration change I had to make to the Coordinator was set the Pan ID to be the same as the Router XBee.</p>
<p><strong>Prepare the Explorer (Regulated)<br />
</strong>In theory I could just connect a few wires to an XBee to make this work, but the break out board has a few benefits. Firstly it means I can swap an XBee in or out of this project without breaking anything. Secondly the break out board has a built in 3.3v voltage regulator so I will have more options for powering the project later. It also has a few status LEDs so I can see what's going on. To use the break out board with a breadboard you need to solder on some pin headers. I decided to put two full strips of pins on mine just give me a few more options for experimentation.</p>
<p><a href="http://www.freakent.co.uk/2013/01/20/look-no-arduino-xbee-sensor-network/img_0357/" rel="attachment wp-att-629"><img class="wp-image-629 alignnone" alt="IMG_0357" src="http://www.freakent.co.uk/wp-content/uploads/2013/01/IMG_0357.jpg" width="250" /></a> <a href="http://www.freakent.co.uk/2013/01/20/look-no-arduino-xbee-sensor-network/img_0355/" rel="attachment wp-att-628"><img class="wp-image-628 alignnone" alt="IMG_0355" src="http://www.freakent.co.uk/wp-content/uploads/2013/01/IMG_0355.jpg" width="250" height="188" /></a></p>
<p><strong>Build the circuit<br />
</strong>With the extra pins soldered to the Explorer it's simple enough to build a simple test circuit on a breadboard. The diagram below shows the layout on the breadboard but with out the XBee fitted so its easier to see the wires.</p>
<p><a href="http://www.freakent.co.uk/wp-content/uploads/2013/06/XBee-Sensor-2_schem.png"><img class="wp-image-776 alignnone" alt="XBee Sensor schematic" src="http://www.freakent.co.uk/wp-content/uploads/2013/06/XBee-Sensor-2_schem.png" width="250" height="232" /></a><a href="http://www.freakent.co.uk/2013/01/20/look-no-arduino-xbee-sensor-network/XBee-sensor-breadboard-2/" rel="attachment wp-att-620"><a href="http://www.freakent.co.uk/wp-content/uploads/2013/06/XBee-Sensor-2_bb.png"><img class="wp-image-775 alignnone" alt="XBee Sensor breadboard" src="http://www.freakent.co.uk/wp-content/uploads/2013/06/XBee-Sensor-2_bb.png" width="250" height="150" /></a></a></p>
<p>&nbsp;</p>
<p>There are four connections to the Explorer; 5V, 3.3V, Gnd and D0. The regulated 3.3V is used to drive the switch circuit. Never, ever put more than 3.3V directly into an XBee (thanks go to N8 for pointing <a href="http://www.digi.com/support/kbase/kbaseresultdetl?id=2160">this article</a> out). D0 is connected to the switch circuit between the LED and the resistor. The resistor will pull the pin LOW when the switch is not being pressed.</p>
<p><strong>Power Up and Test<br />
</strong>All that remains is to power everything up and test it. Ensure that the Coordinator module is in the XBee Explorer USB and connected to the PC and that the Router module is in the Explorer (Regulated) on the breadboard. X-CTU should be running on the PC and the Terminal tab selected. Connect a power supply to the breadboard and you should see the power LED light up on the Explorer. When you press the switch you should see the RSS LED light on both the Regulator's and Coordinator's Explorers, and you should see the received data displayed in X-CTU. When you release the switch you should see another message in X-CTU. After a short while of inactivity the RSS lights should go out to show that the modules have disconnected.</p>
<p><a href="http://www.freakent.co.uk/2013/01/20/look-no-arduino-xbee-sensor-network/data1/" rel="attachment wp-att-631"><img class=" wp-image-631 alignnone" alt="Data1" src="http://www.freakent.co.uk/wp-content/uploads/2013/01/Data1.png" width="250" height="323" /></a><a href="http://www.freakent.co.uk/2013/01/20/look-no-arduino-xbee-sensor-network/data2/" rel="attachment wp-att-632"><img class=" wp-image-632 alignnone" style="margin-left: 5px; margin-right: 5px;" alt="Data2" src="http://www.freakent.co.uk/wp-content/uploads/2013/01/Data2.png" width="250" height="323" /></a></p>
<p><strong>Interpreting the Data </strong><br />
X-CTU displays the complete API frame as received by the Coordinator. The message starts with a delimiter byte, 0x7E. The next 14 bytes are header information that mostly describe message length, 64bit and 16bit message sender addresses. The next 6 bytes are what interest us. I have laid them out in a table below and provided values for when the switch is down (pressed) and up (released).</p>
<table border="1">
<thead>
<tr>
<th>Bytes</th>
<th>Name</th>
<th>Notes</th>
<th>Switch Down</th>
<th>Switch Up</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Sample Sets</td>
<td>Samples in packet, always 1</td>
<td>0x01</td>
<td>0x01</td>
</tr>
<tr>
<td>2</td>
<td>Digital channel mask</td>
<td>Which digital inputs have sampling enabled</td>
<td>0x00 0x01</td>
<td>0x00 0x01</td>
</tr>
<tr>
<td>1</td>
<td>Analog channel mask</td>
<td>Which analog inputs have sampling enabled</td>
<td>0x00</td>
<td>0x00</td>
</tr>
<tr>
<td>2</td>
<td>Digital IO data</td>
<td>Actual data values</td>
<td>0x00 0x01</td>
<td>0x00 0x00</td>
</tr>
</tbody>
</table>
<p>The final byte is a checksum byte to help verify message integrity.</p>
<p>Next step is to see how the Java <a href="http://code.google.com/p/xbee-api/" target="_blank">XBee-API</a> handles these messages and update my <a href="https://github.com/freakent/xbee-component/tree/master/src/main/java/freakent/camel/component" target="_blank">Apache Camel component</a> appropriately.</p>
<p><strong>Useful Links</strong></p>
<ul>
<li><a href="http://examples.digi.com/sensors/802-15-4-digital-input-with-a-button/">802.15.4 Digital Input with a Button</a></li>
</ul>
